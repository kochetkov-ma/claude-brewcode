Делаем через SDK расширение-палагин для Claude

Расширение позволяет работать по задаче бесконечно фиксируя прогресс в файле-плане по задаче. `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md` и знания по задаче в `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK_KNOWLEDGE.jsonl`

Flow:
- (CALL SKILL) `/focus-task:create` <User PROMT or Task file or default file `.claude/TASK.md`> 
- В рамках команды (SKILL) `/focus-task:create`
  - Фиксируется лок, то есть создается или обновляется файл `.claude/TASK.md` переводится в статус `creating` - пока этот статус ДРУГИЕ запуски команды `/focus-task:create` должны падать сразу
  - Анализ, пред-планирование и создание спецификации в `.claude/tasks/specs/<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_SPEC_vX.md` по инструкциям из команды `/focus-task`
  - после пред-планинга создание `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md` в папке `.claude/tasks/` 
  - для создания `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md` будет лежать спец шаблон для создания задач адаптированный под конкретный проект `.claude/tasks/templates/TASK.md.template`
  - создание пустого `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK_KNOWLEDGE.jsonl` 
    - в задаче должна быть ссылка на созданный `TASK_KNOWLEDGE` и `SPEC_vX`
  - Общий статус внутри `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md` устанавливается как `created` - значит задача создана и готова
  - после создания отписаться в `.claude/TASK.md` какая текущая задача полный путь до нее и статус `created` - значит `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md` создана задача
    - Важно понимать что `.claude/TASK.md` это для удобства является ссылкой на созданную задачу и НЕ обновляется на этапе ВЫПОЛНЕНИЯ, а играет Роль лока и ссылки только на этапе СОЗДАНИЯ задачи НЕ выполнения  
- (CALL SKILL) `/focus-task:start` <Specified Task file or default file `.claude/TASK.md`>
  - если ничего не указано в Аргументах, то нужно прочитать `.claude/TASK.md` взять оттуда ПОЛНЫЙ ПУТЬ ДО `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md` и начать выполнение
  - если указан путь до конкретной Задачи `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md` то сразу начинать выполнение по инструкциям из команды
  - Перед началом выполнения общий статус `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md` переводится в `in progress`
  - Если контекст близок к лимиту или требуется прерывание, статус переводится в `handoff` для передачи следующей сессии
  - После завершения каждой фазы запускается Агент Координатор который проверяет что `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md` обновлены все статусы, все результаты. 
    И проверяется файл знаний `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK_KNOWLEDGE.jsonl`, формируется упакованный файл - отсекается лишние знания или объединяются в одно чтобы выходило НЕ более 5%-10% (настраивается) всего контекста (**Если место еще есть, то просто проверяет нет ли дублей в знаниях**)
  - Перед запуском Фазы в каждый задействованный Агент исполнитель (не Explorer) передаются знания из `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK_KNOWLEDGE.jsonl` в удобном виде [Это реализуется через `SDK`]
  - Выполнение завершается ТОЛЬКО после выполнения условия завершения задачи когда ВСЕ Фазы выполнены и пройдено финальное review успешно. Тогда общий статус помечается как `finished`

Принципы:
- Есть задача TASK `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md` где ведется полный лог выполнения расписаны Фазы, ведется индекс всех файлов контекста в задаче
- Есть файл знаний KNOWLEDGE `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK_KNOWLEDGE.jsonl` который пополняется во время выполнения задачи 3 типа данных - нейтральные новые знания + best practice + avoid ошибка как делать НЕ нужно (в задаче также хранится Lazy ссылка на файл знаний) [Это реализуется через `SDK`]
    - формат типа
  ```
  {"ts":"2026-01-26T14:00:00","cat":"docker","t":"❌","txt":"skip docker check → hang"}                                                                                                                    ─
  {"ts":"2026-01-26T14:05:00","cat":"docker","t":"✅","txt":"docker info first"}                                                                                                                            
  {"ts":"2026-01-26T15:00:00","cat":"db","t":"ℹ️","txt":"test postgres: localhost:5432"}
  ```
- Задача выполняется по Фазам, каждая Фаза ИСКЛЮЧИТЕЛЬНО через Sub-Agents
- Специальный агент Координатор поддерживает Актуальность файла задачи `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md`
- Есть лимит настраиваемый на 90% по умолчанию когда [Это реализуется через `SDK`]
    - Перед завершением сессии запускается Координатор, проверяет что `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md` обновлены все статусы, все результаты и фиксирует конечный статус. Если задача не сделана, то переводи ВСЮ задачу в общий статус `handoff` - готова к передаче в следующую сессию
      - Важно  
    - Перед завершением сессии также Координатором проверяется файл знаний, формируется упакованный файл - отсекается лишние знания или объединяются в одно чтобы выходило НЕ более 5%-10% (настраивается) контекста
    - Очищается контекст полностью
    - Загружается НОВЫЙ контекст
    - В новой сессии сразу подгружается оптимизированный файл знаний + ...TASK.md
    - продолжается работа по TASK.md с места прошлого

Таким образом обеспечиваем бесконечный цикл так как знания всегда ограничены и актуальный статус задачи
Структура plain для хранения задач ВНУТРИ ПРОЕКТА:
```
.claude/tasks/
  - <TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK.md
  - <TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK_KNOWLEDGE.jsonl
  - /specs/
    - <TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_SPEC_vX.md
```

Можно ли это сделать через SDK и сделать свой плагин? БЕЗ overengineering

И по KNOWLEDGE:
После каждой Фазы Sub-Агент должен перед завершением добавлять TASK_KNOWLEDGE от себя. 
Естественно Ограниченное кол-во из настроек. За уникальностью будет следить отдельный Агент Координатор.
Максимально кол-во записей от одного агента должно быть ограничено от 0 до 5 - через настройки

Также в шаблоне промта для задачи зашиты POST финальные Фазы:
- обновление Агентской документации `.claude/` и памяти проекта
- обновление внутренней пользовательской документации по проекту на основе спеки `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_SPEC_vX.md` создается постоянная спека для человека (на русском) в папке `.claude/specs/` и индексируется в проектной памяти
- обновление best-practice и `rules/` и `rules/avoid` на основе САМЫХ критических знаний из `<TIMESTAMP(DDMMYYYY_HHMMSS)>_<name>_TASK_KNOWLEDGE.jsonl`